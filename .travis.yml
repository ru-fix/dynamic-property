language: java
jdk:
  - openjdk11
cache:
  directories:
    - "$HOME/.gradle"
jobs:
  include:
    - stage: build
      if: tag IS blank
      install: skip
      before_script: openssl aes-256-cbc -K $encrypted_01979cd038ed_key -iv $encrypted_01979cd038ed_iv -in secring.gpg.enc -out secring.gpg -d
      script: ./gradlew clean build

    - stage: deploy
      if: tag =~ ^\d+\.\d+\.\d+$
      install: skip
      before_script: openssl aes-256-cbc -K $encrypted_01979cd038ed_key -iv $encrypted_01979cd038ed_iv -in secring.gpg.enc -out secring.gpg -d
      script: ./gradlew -Dorg.gradle.internal.publish.checksums.insecure=true --info clean build publishToSonatype closeAndReleaseRepository
env:
  global:
    - signingSecretKeyRingFile="`pwd`/secring.gpg"
    - secure: "4cPpWXvbLjF41qybVp9Nl1k4sBotVUNOhvJ+jtSfUoIoQIpJi8Ftfl9GPnSQaJ+m49wnvQYum0yBlaM/Xu7AND9K9SWBR4kHyPJKYm8k7imFoCDdt277A6eA5gtgCMWDtEZUal58Tr7PcRwNjvAHQTW+ciE9+ga0A04e5dFLhoP+iTpt8T1aj2cWu4baCQDKV2CHFZdkwRz3UHMPYOdIX9TL74m9KPpsTZMEtUCxktgpbNyzS7SKH6ceAhGNxf8T92IlMsq9oLhprU7gPj5v6H2TdMURmTw2hWSmWAPuBskIJl7RexOhGqUTyI8wIl4+tW/MpbGO05wKh/D9k1J9ErTRes+r9CMGlovxejCpAUwsVy+zE1lDi1OvkOxFzEDINqAauaMe8VM10aZfRVUao1V5Zwv8db8gtUwNTUTrboOWIR5R+/exQBNpLwZxwzRedX/UKWu3dTPs4qLjWtKwU9q9H9Ca13qtR2aoQ9vWL851Use0rw+8XIK0SHukUZjjDyJKRLc6CuJtytWf+WbQ9ZdeN6nP6aMzbzsdw4SyidIdpJduF92C1cIY98E0qaKY34a6tFeqjdzAjjJV4yjQFfxJK3JOvKOmCz4Ei/Wq80gfDw9cdvyTQyw2FYkw29Ed7OoMBDAKUXS55VHgxUilqlpU/Od92DutFvImOFM04Nc="
    - secure: "jLIwUpS5tQ30HywxZzMZKih7hgRnSqjRNy0g6j5E99Qm42jtyJmkB2OTMk1rktnb1A6mx/rBdGL/7Oag5ZbLo45F+6uV6EoCO4ayO+60r0u3vDiG6XQmYdFqeVHB4uiqJe3Z/Jv1xC0HYV6XArzE/N56aMfRmNNFwlNJYGXj46tBo0QD5cHgl1MyjiZNl7pxmdvasy5zdlfUnizDHmNxewR2AVeSzyCzq6Rg8mxIt9bHy8hOkj7bcYo1l4cpe9bGZafxWCyybS9bb8z1Wp2pGtuqpJIWcBWEJttNGAamxphtNQNJSS+6nMOeB5sQfEup3AjUms3ihe112//jFc6fYGmiVuhtZ8WGsAfIxZSShaM29ccwwfCLtKZKrUTrgBuUl8oj+ogJeUbMdGNEO/sY+ibbKkyt+X0Y8sDS8GwJIwDixVDjGeJ4aR2KHnf+lZzoAhCQHIIZV6pqiXRcCKRifOmz3VQgsqOOmZ2is7e7PqmGAcH45lYYB/a8DluKHob1tsdKthL4xvNgDmS0ZmAaMCO4VRDXXSD/vIX1sPWB+lGbefg/H8xNcAfCXMoUMmBjqDnaUGJmoGNcb19O9f7juHZQ0beD1cMpwSJWxqoUGBND/u+9bVP92TmzLz4++ssHHIhgTEEXINW6OqjZOuzI7ISm/l50WIZ2yh9cE7ShTi8="
    - secure: "ia9JR7y0cRXIsuEWvVpCy4HUeSX4YhhwctHIos8Xr8KZ+eHRowujtmo5Rq3FaTgEfA6+KA/hIO1VYLEd+R4xJp7f2aGAIec9+Gk6KQ3XnkuudwtFpNQw5VwDuHB2Tjqv3hBt8oybNDQ75OEBIiNNge4nTQmF9l6yJEH7+8+lhYA63tynSs4KrtEqX+UN/7nBQi5FHskIcHr3gfxbI35EISUtPvF78ZPYcUNSzCDmHNMbMKbjWDc4t/LlP/1MLTvbVyFTkzomthreogLtpjFWGJpGjkFyjzpSxQ7k4FHllciftvpIE7tcFdaCRoiPocWnX2BIR+GU5DV1Zo6j3J5ttyxIcIH8224g30GfZewudcN3WXgXCMU7Kto1y2kO5nljvo74WgqiXILAFJ7+Gyun5VpxeGIUkmN5FBQJxd0W/zSDHkv5JTn2Gapo3yUOMKRl6Jc5oIeMQdDWCh/zLOcDEpPiu2T6EumiYud0dG8KpbiYEXaAuJk8f4422+RR0wyQxexrKKDl5t9T9jncaZAY7dklI1gMITcaY6v46/JB1qhMl3Ev6MM2E5yoz96cgOjSpRNOwmwn9/YibSXCPz+k9HW1vSeHM4atCFUugPh3QmMapocyNLoeFvf/JEADKeb2RT1Q+HdSnosMofUcKJcXKUhUOJmr8s//DXf5akjFShA="
    - secure: "VTVeQU4TnSKf6mB2mCNH2tCRbCttDKNzf1KDuBY+dg9jrpDR5dlpWYDxcSrkhDWZ39Z15E5FoubBgGKYFhN2JDJ790T7/5eCG+pZh1JHQw29vwoKkF6AwuioZ3uoiV6FQ3uyUEStgPe+NqxhQprmPlRcsNXwxz8lk5JEirjhaqPEMvl+8vplN7OpScEbTae8lrdCohntIjeJIScywnKkf032k4oHaYrSy7Xb62FgNZqDOlNuqE2sCO6AT+zQdWV7fl8jsL0ln//2Wq+Gtd7cJJteozqWPqT/0+Pco3h9s0aLi5AmjrgiuW2PXAdw91HpDyI3syt5U2UYI/wSaGPvZBWLq99HN+v+IlbJZVRTSj9eSqG4tEvDHM+P6IRXGOaiqSbs+obejHKX89ejCtpCecVF/XvJBKUnRjhbqbgoYXkbJB/xsimM7YwzwujEm8AG5XnGUTglBfvueoxYYgfcntWHYZInXvREpLFRi1w6VByd9uvlFilrsEcPQluSPw7e9aR3/fPsFZQGSVFydeVwQth+BcMo0u6a3ph2DdILT6BnEqGi6My9qr5+8/wT3CobtLlvTuFrZcRTsVWfuplGAVHSxWZ3Yftb9msIaRghti7Koo0P0IBN5hvG/5wGL+Kbs8L/Z+QuzcSCfTPe1zHNvTEc2oPi+MNENOcvKWKTxtI="
    - secure: "Yd/uoiJxUlwbCG9WqTFmYYp/fLKrsc6dehdDh/+0MY9A5oapermZel/RmaCpOGymTfJa3CmLmJLIpip0Ht0LF4XlbPX7ifTYF1Wcky0JPUdWcPsc1+CDjqOFX7M6Qd29vQkyvui6eWQrlUOYEtIBwzXIBAfyRePV+AO8vydspDKIoqA+Xq7z1Qxr/mQtuLsnPzWtLvgfdMavAtSe/XYICdVyVvAogKSLY//4bCOo6V+Nzh5swncOLq4nxYbz1EpLmmjiANFV5onB7Ieokmxit2baLklx08yDojs8Tn/fBvcC4Z8hMOV/iT4M3Om8jbtMzataxwwoLDAJkWr9WYykGQnoUt9LuEx6gIdisXCuROFHNVv16z7BvUKCsgZ4qjElaDn3ha902QmBRZuukWXW9YtvOaICU3Fp7ax/0ewvdUNjiopBGr8sb+TnngMKvJ+PsuUoWfMGpZExJBu4Y0czl8gFO2aPvfDZU/8rHecSzj7yaeM9Zcy4mFP5kKdGe8X7dazBO6IAQHlaDKZVe/QZP+r0ADYopFpA/FRIixESkINVRnQYtmpWojVGx2CExPfgkOgVcKk4WJX+LgywrBpFalNCerp39+DspKsS0xXg4KdAS73qi1t7UW6McoqoSaeqDrcWF6RQVQk082DqZgNrsfnVD0a7g7opIADjh5fK6SI="
